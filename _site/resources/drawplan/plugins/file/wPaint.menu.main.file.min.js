/*! wPaint - v2.5.0 - 2014-03-01 */
//alert(screen.width);

    function saveimg() {
	if (screen.width < 810){
	    var imgCanvas = document.getElementById('wPaint-canvas');
 var imgAsDataURL = imgCanvas.toDataURL("image/png");

window.localStorage.canvasImage = imgAsDataURL;
	alert('saved');
	} else {
	var canvas = document.getElementById('wPaint-canvas');
      var context = canvas.getContext('2d');
      // save canvas image as data url (png format by default)
      var dataURL = canvas.toDataURL();

      // set canvasImg image src to dataURL
      // so it can be saved as an image
//document.getElementById('canvasImg').href = dataURL;
OpenInNewTab(dataURL);
 //$("#canvasImg").click();
	}
    }
function saveimglocal() {
    if (screen.width < 810) {
		var canvas = document.getElementById('wPaint-canvas');
      var context = canvas.getContext('2d');
      // save canvas image as data url (png format by default)
    var dataURL = canvas.toDataURL();

      // set canvasImg image src to dataURL
      // so it can be saved as an image
//document.getElementById('canvasImg').href = dataURL;
OpenInNewTab(dataURL);
	//$("#canvasImg").click();
    } else {
	     var imgCanvas = document.getElementById('wPaint-canvas');
 var imgAsDataURL = imgCanvas.toDataURL("image/png");

window.localStorage.canvasImage = imgAsDataURL;
alert('saved to local storage');
    }
}
function loadimg() {
        if (screen.width < 810) {
    document.getElementById('hihi').src =  window.localStorage.canvasImage;
       var c = document.getElementById("wPaint-canvas");
    var ctx = c.getContext("2d");
    var img = document.getElementById("hihi");
	    ctx.drawImage(img,10,10);
	} else {
 $("#imageLoader").click();
	}
    }


function loadimglocal() {
        if (screen.width < 810) {
	    $("#imageLoader").click();

	} else {
	        document.getElementById('hihi').src =  window.localStorage.canvasImage;
       var c = document.getElementById("wPaint-canvas");
    var ctx = c.getContext("2d");
    var img = document.getElementById("hihi");
	    ctx.drawImage(img,10,10);
	}
}

!function(a){
var b="plugins/file/img/icons-menu-main-file.png";a.extend(!0,a.fn.wPaint.menus.main.items,{
save:{
    icon:"generic",group:"save",title:"Save Image",img:b,index:0,callback:function(){
//	this.options.saveImg.apply(this,[this.getImage()])
	//	alert('hi');
	saveimg();
}
}
       ,loadIMG:{
icon:"generic",group:"save",title:"Save Image to Local Storage",img:b,index:1,callback:function(){
//this.options.savePng.apply(this,[])
    // alert('hi');
    saveimglocal();
}
}
,loadBg:{
icon:"generic",group:"loadImg",title:"Load Image to Foreground",img:b,index:2,callback:function(){
//this.options.loadImgFg.apply(this,[])
    loadimg();
}
}
,loadFg:{
icon:"generic",group:"loadImg",title:"Load Image From Local Storage",img:b,index:1,callback:function(){
//this.options.loadImgBg.apply(this,[])
    loadimglocal();
}
}
 
}
),a.extend(a.fn.wPaint.defaults,{
saveImg:null,loadImgFg:null,loadImgBg:null
}
),a.fn.wPaint.extend({
_showFileModal:function(b,c){
function d(a,b){
function c(c){
c.stopPropagation(),"fg"===a?e.setImage(b):"bg"===a&&e.setBg(b,null,null,!0)
}
g.on("click",c)
}
for(var e=this,f=a("<div></div>"),g=null,h=0,i=c.length;i>h;h++)g=a('<img class="wPaint-modal-img"/>').attr("src",c[h]),g=a('<div class="wPaint-modal-img-holder"></div>').append(g),d(b,c[h]),f.append(g);this._showModal(f)
}
}
)
}
(jQuery);

